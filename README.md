This code is from http://www.outyear.co.uk/smint/

I've modified it.
